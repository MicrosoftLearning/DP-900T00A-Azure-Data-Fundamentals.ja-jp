---
ms.openlocfilehash: 496981207a34eb019688e8f2583ccc1abcbb5bce
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050955"
---
<a name="semver1----the-semantic-versioner-for-npm"></a>semver(1) -- npm のセマンティック バージョナー
===========================================

## <a name="install"></a>[インストール]

```bash
npm install --save semver
````

## <a name="usage"></a>使用

ノード モジュールとして:

```js
const semver = require('semver')

semver.valid('1.2.3') // '1.2.3'
semver.valid('a.b.c') // null
semver.clean('  =v1.2.3   ') // '1.2.3'
semver.satisfies('1.2.3', '1.x || >=2.5.0 || 5.0.0 - 7.2.3') // true
semver.gt('1.2.3', '9.8.7') // false
semver.lt('1.2.3', '9.8.7') // true
semver.minVersion('>=1.0.0') // '1.0.0'
semver.valid(semver.coerce('v2')) // '2.0.0'
semver.valid(semver.coerce('42.6.7.9.3-alpha')) // '42.6.7'
```

コマンド ライン ユーティリティとして:

```
$ semver -h

A JavaScript implementation of the https://semver.org/ specification
Copyright Isaac Z. Schlueter

Usage: semver [options] <version> [<version> [...]]
Prints valid versions sorted by SemVer precedence

Options:
-r --range <range>
        Print versions that match the specified range.

-i --increment [<level>]
        Increment a version by the specified level.  Level can
        be one of: major, minor, patch, premajor, preminor,
        prepatch, or prerelease.  Default level is 'patch'.
        Only one version may be specified.

--preid <identifier>
        Identifier to be used to prefix premajor, preminor,
        prepatch or prerelease version increments.

-l --loose
        Interpret versions and ranges loosely

-p --include-prerelease
        Always include prerelease versions in range matching

-c --coerce
        Coerce a string into SemVer if possible
        (does not imply --loose)

Program exits successfully if any valid version satisfies
all supplied ranges, and prints all satisfying versions.

If no satisfying versions are found, then exits failure.

Versions are printed in ascending order, so supplying
multiple versions to the utility will just sort them.
```

## <a name="versions"></a>バージョン

"バージョン" は、<https://semver.org/> にある `v2.0.0` 仕様によって記述されています。

先頭の `"="` または `"v"` 文字は削除され、無視されます。

## <a name="ranges"></a>範囲

`version range` は、範囲を満たすバージョンを指定する `comparators` のセットです。

`comparator` は `operator` と `version` で構成されています。  プリミティブ `operators` のセットは次のとおりです。

* `<`: より小さい
* `<=`: 以下
* `>`: より大きい
* `>=`: 以上
* `=`: 等しい。  演算子が指定されていない場合は、等値が想定されるため、この演算子は省略可能ですが、含めることもできます。

たとえば、比較演算子 `>=1.2.7` はバージョン `1.2.7`、`1.2.8`、`2.5.3`、および `1.3.9` と一致しますが、バージョン `1.2.6` や `1.1.0` とは一致しません。

比較演算子は、空白で結合して `comparator set` を形成できます。これは、含まれるすべての比較演算子の **積集合** によって満たされます。

範囲は、1 つ以上の比較演算子セットで構成され、`||` で結合されます。  バージョンは、`||` で区切られた 1 つ以上の比較演算子セット内のすべての比較演算子がバージョンによって満たされている場合にのみ、範囲と一致します。

たとえば、範囲 `>=1.2.7 <1.3.0` はバージョン `1.2.7`、`1.2.8`、および `1.2.99` と一致しますが、バージョン `1.2.6`、`1.3.0`、または `1.1.0` とは一致しません。

範囲 `1.2.7 || >=1.2.9 <2.0.0` はバージョン `1.2.7`、`1.2.9`、および `1.4.6` と一致しますが、バージョン `1.2.8` または `2.0.0` とは一致しません。

### <a name="prerelease-tags"></a>プレリリース タグ

バージョンにプレリリース タグ (たとえば、`1.2.3-alpha.3`) が含まれる場合は、同じ `[major, minor, patch]` タプルを持つ 1 つ以上の比較演算子にもプレリリース タグが含まれる場合にのみ、比較演算子セットを満たすことができます。

たとえば、範囲 `>1.2.3-alpha.3` はバージョン `1.2.3-alpha.7` と一致できますが、SemVer 並べ替え規則に従うと厳密には `3.4.5-alpha.9` は `1.2.3-alpha.3` "より大きい" ものの、範囲は `3.4.5-alpha.9` によって "*満たされません*"。  バージョン範囲では、`1.2.3` バージョンのプレリリース タグのみが受け入れられます。  バージョン `3.4.5` にはプレリリース フラグが含まれず、`3.4.5` は `1.2.3-alpha.7` より大きいため、範囲を "*満たします*"。

この動作の目的は 2 つあります。  第 1 に、プレリリース バージョンは頻繁かつ非常に迅速に更新され、まだ一般消費に適していない (作成者の設計による) 多くの破壊的変更が含まれています。
したがって、既定では、範囲一致セマンティクスから除外されます。

第 2 に、プレリリース バージョンの使用を選択したユーザーは、"*その特定の*" alpha/beta/rc バージョンのセットを使用する意図を明確に示しています。  範囲内にプレリリース タグを含めることで、ユーザーはリスクを認識していることを示します。  ただし、プレリリース バージョンの "*次の*" セットで同様のリスクを負うことを選択したと想定するのは適切ではありません。

この動作は、範囲一致を行う[関数](https://github.com/npm/node-semver#functions)に options オブジェクトの `includePrerelease` フラグを設定することで抑制する (範囲一致のために、すべてのプレリリース バージョンを通常のバージョンとして扱う) ことができます。

#### <a name="prerelease-identifiers"></a>プレリリース識別子

このメソッド `.inc` は、プレリリース識別子として文字列の値を追加する追加の `identifier` 文字列引数を受け取ります。

```javascript
semver.inc('1.2.3', 'prerelease', 'beta')
// '1.2.4-beta.0'
```

コマンド ラインの例:

```bash
$ semver 1.2.3 -i prerelease --preid beta
1.2.4-beta.0
```

これを使用して、さらに増分できます。

```bash
$ semver 1.2.4-beta.0 -i prerelease
1.2.4-beta.1
```

### <a name="advanced-range-syntax"></a>高度な範囲の構文

高度な範囲の構文は、確定的な方法でプリミティブ比較演算子に変換されます。

高度な範囲は、空白または `||` を使用してプリミティブ比較演算子と同じ方法で結合できます。

#### <a name="hyphen-ranges-xyz---abc"></a>ハイフン範囲 `X.Y.Z - A.B.C`

包含セットを指定します。

* `1.2.3 - 2.3.4` := `>=1.2.3 <=2.3.4`

部分的なバージョンが包含範囲の最初のバージョンとして指定されている場合、欠落している部分は 0 に置き換えられます。

* `1.2 - 2.3.4` := `>=1.2.0 <=2.3.4`

部分的なバージョンが包含範囲の 2 番目のバージョンとして指定されている場合、指定されたタプル部分で始まるすべてのバージョンが受け入れられますが、指定されたタプル部分より大きいバージョンは受け入れられません。

* `1.2.3 - 2.3` := `>=1.2.3 <2.4.0`
* `1.2.3 - 2` := `>=1.2.3 <3.0.0`

#### <a name="x-ranges-12x-1x-12-"></a>X 範囲 `1.2.x` `1.X` `1.2.*` `*`

`[major, minor, patch]` タプル内のいずれかの数値の "代わり"に、`X`、`x`、または `*` のいずれかを使用できます。

* `*` := `>=0.0.0` (すべてのバージョンによって満たされます)
* `1.x` := `>=1.0.0 <2.0.0` (一致するメジャー バージョン)
* `1.2.x` := `>=1.2.0 <1.3.0` (一致するメジャー バージョンとマイナー バージョン)

部分的なバージョン範囲は X 範囲として扱われるので、特殊文字は実際には省略可能です。

* `""` (空の文字列) := `*` := `>=0.0.0`
* `1` := `1.x.x` := `>=1.0.0 <2.0.0`
* `1.2` := `1.2.x` := `>=1.2.0 <1.3.0`

#### <a name="tilde-ranges-123-12-1"></a>チルダ範囲 `~1.2.3` `~1.2` `~1`

比較演算子にマイナー バージョンが指定されている場合は、パッチ レベルの変更を許可します。  マイナー レベルの変更が許可されていない場合は許可します。

* `~1.2.3` := `>=1.2.3 <1.(2+1).0` := `>=1.2.3 <1.3.0`
* `~1.2` := `>=1.2.0 <1.(2+1).0` := `>=1.2.0 <1.3.0` (`1.2.x` と同じ)
* `~1` := `>=1.0.0 <(1+1).0.0` := `>=1.0.0 <2.0.0` (`1.x` と同じ)
* `~0.2.3` := `>=0.2.3 <0.(2+1).0` := `>=0.2.3 <0.3.0`
* `~0.2` := `>=0.2.0 <0.(2+1).0` := `>=0.2.0 <0.3.0` (`0.2.x` と同じ)
* `~0` := `>=0.0.0 <(0+1).0.0` := `>=0.0.0 <1.0.0` (`0.x` と同じ)
* `~1.2.3-beta.2` := `>=1.2.3-beta.2 <1.3.0`: `1.2.3` バージョン内のプレリリースは、`beta.2` 以上であれば許可されます。  したがって、`1.2.3-beta.4` は許可されますが、`1.2.4-beta.2` は別の `[major, minor, patch]` タプルのプレリリースであるため、許可されません。

#### <a name="caret-ranges-123-025-004"></a>キャレット範囲 `^1.2.3` `^0.2.5` `^0.0.4`

`[major, minor, patch]` タプル内の左端にある 0 以外の数字を変更することのない変更を許可します。  言い換えると、これにより、バージョン `1.0.0` 以上のパッチ更新プログラムとマイナー更新プログラム、およびバージョン `0.X >=0.1.0` のパッチ更新プログラムは許可されますが、バージョン `0.0.X` のいずれの更新プログラムも "*許可されません*"。

多くの作成者は、`x` がメジャーな "破壊的変更" インジケーターであるかのように `0.x` バージョンを扱います。

キャレット範囲は、作成者が `0.2.4` と `0.3.0` のリリース間で破壊的変更を加える可能性がある場合に最適であり、一般的な方法です。
ただし、`0.2.4` と `0.2.5` の間で破壊的変更を "*行わない*" ことが想定されています。  これにより、一般的に用いられる方法に従って、追加 (ただし非破壊的) であると想定される変更が許可されます。

* `^1.2.3` := `>=1.2.3 <2.0.0`
* `^0.2.3` := `>=0.2.3 <0.3.0`
* `^0.0.3` := `>=0.0.3 <0.0.4`
* `^1.2.3-beta.2` := `>=1.2.3-beta.2 <2.0.0`: `1.2.3` バージョン内のプレリリースは、`beta.2` 以上であれば許可されます。  したがって、`1.2.3-beta.4` は許可されますが、`1.2.4-beta.2` は別の `[major, minor, patch]` タプルのプレリリースであるため、許可されません。
* `^0.0.3-beta` := `>=0.0.3-beta <0.0.4`: `0.0.3` バージョン内のプレリリースは、`beta` 以上である場合に "*のみ*" 許可されます。  したがって、`0.0.3-pr.2` は許可されます。

キャレット範囲を解析する場合、欠落している `patch` 値は数値 `0` に変換されますが、メジャー バージョンとマイナー バージョンの両方が `0` であっても、その値内で柔軟性が許容されます。

* `^1.2.x` := `>=1.2.0 <2.0.0`
* `^0.0.x` := `>=0.0.0 <0.1.0`
* `^0.0` := `>=0.0.0 <0.1.0`

欠落している `minor` 値と `patch` 値は 0 に変換されますが、メジャー バージョンが 0 であっても、それらの値内で柔軟性が許容されます。

* `^1.x` := `>=1.0.0 <2.0.0`
* `^0.x` := `>=0.0.0 <1.0.0`

### <a name="range-grammar"></a>範囲の文法

要約として、パーサー作成者のために範囲のバッカスナウア文法を次に示します。

```bnf
range-set  ::= range ( logical-or range ) *
logical-or ::= ( ' ' ) * '||' ( ' ' ) *
range      ::= hyphen | simple ( ' ' simple ) * | ''
hyphen     ::= partial ' - ' partial
simple     ::= primitive | partial | tilde | caret
primitive  ::= ( '<' | '>' | '>=' | '<=' | '=' ) partial
partial    ::= xr ( '.' xr ( '.' xr qualifier ? )? )?
xr         ::= 'x' | 'X' | '*' | nr
nr         ::= '0' | ['1'-'9'] ( ['0'-'9'] ) *
tilde      ::= '~' partial
caret      ::= '^' partial
qualifier  ::= ( '-' pre )? ( '+' build )?
pre        ::= parts
build      ::= parts
parts      ::= part ( '.' part ) *
part       ::= nr | [-0-9A-Za-z]+
```

## <a name="functions"></a>関数

すべてのメソッドとクラスは、最終的な `options` オブジェクト引数を受け取ります。  このオブジェクトのすべてのオプションは、既定で `false` です。  サポートされているオプションは次のとおりです。

- `loose`: あまり有効でない semver 文字列について、もっと寛大に対処します
  (当然ながら、得られる出力は常に 100% 厳密に準拠します)。下位互換性の理由から、`options` 引数がオブジェクトではなくブール値である場合は、`loose` パラメーターとして解釈されます。
- `includePrerelease`: 明示的に選択されない限り、プレリリース タグ付きバージョンを範囲から除外する[既定の動作](https://github.com/npm/node-semver#prerelease-tags)を抑制するように設定します。

厳密モードの比較演算子と範囲は、解析する SemVer 文字列に対して厳密になります。

* `valid(v)`:解析されたバージョンを返します。無効な場合は null を返します。
* `inc(v, release)`:リリースの種類 (`major`、`premajor`、`minor`、`preminor`、`patch`、`prepatch`、`prerelease`) で増分されたバージョンを返します。無効な場合は null を返します。
  * 1 回の呼び出し内の `premajor` により、バージョンが次のメジャー バージョンに移行し、そのメジャー バージョンのプレリリースになります。
    `preminor` と `prepatch` も同様に動作します。
  * プレリリース以外のバージョンから呼び出された場合、`prerelease` は `prepatch` と同様に動作します。 パッチ バージョンが増分され、プレリリースが作成されます。 入力バージョンが既にプレリリースである場合は、単に増分されます。
* `prerelease(v)`:プレリリース コンポーネントの配列を返します。存在しない場合は null を返します。 例 : `prerelease('1.2.3-alpha.1') -> ['alpha', 1]`
* `major(v)`:メジャー バージョン番号を返します。
* `minor(v)`:マイナー バージョン番号を返します。
* `patch(v)`:パッチ バージョン番号を返します。
* `intersects(r1, r2, loose)`:指定された 2 つの範囲または比較演算子が交差する場合は、true を返します。
* `parse(v)`:文字列をセマンティック バージョンとして解析しようとし、`SemVer` オブジェクトまたは `null` を返します。

### <a name="comparison"></a>比較

* `gt(v1, v2)`: `v1 > v2`
* `gte(v1, v2)`: `v1 >= v2`
* `lt(v1, v2)`: `v1 < v2`
* `lte(v1, v2)`: `v1 <= v2`
* `eq(v1, v2)`:`v1 == v2`: まったく同じ文字列でなくても、論理的に等価である場合に当てはまります。  文字列を比較する方法については既に説明しました。
* `neq(v1, v2)`:`v1 != v2`: `eq` の反対です。
* `cmp(v1, comparator, v2)`:比較文字列を渡すと、上記の対応する関数が呼び出されます。  `"==="` と `"!=="` は単純な文字列比較を行うものですが、完全性のために含まれています。  無効な比較文字列が指定された場合にスローされます。
* `compare(v1, v2)`:`v1 == v2` の場合は `0`、`v1` の方が大きい場合は `1`、`v2` の方が大きい場合は `-1` を返します。  `Array.sort()` に渡された場合、昇順に並べ替えられます。
* `rcompare(v1, v2)`:比較の逆。  `Array.sort()` に渡された場合、バージョンの配列が降順に並べ替えられます。
* `diff(v1, v2)`:リリースの種類 (`major`、`premajor`、`minor`、`preminor`、`patch`、`prepatch`、`prerelease`) による 2 つのバージョンの差を返します。バージョンが同じ場合は、null を返します。

### <a name="comparators"></a>比較演算子

* `intersects(comparator)`:比較演算子が交差する場合は、true を返します。

### <a name="ranges"></a>範囲

* `validRange(range)`:有効な範囲を返します。無効な場合は null を返します。
* `satisfies(version, range)`:バージョンが範囲を満たしている場合は、true を返します。
* `maxSatisfying(versions, range)`:範囲を満たす一覧の中で最も大きいバージョンを返します。どれも範囲を満たしていない場合は、`null` を返します。
* `minSatisfying(versions, range)`:範囲を満たす一覧の中で最も小さいバージョンを返します。どれも範囲を満たしていない場合は、`null` を返します。
* `minVersion(range)`:指定された範囲と一致する可能性がある最も小さいバージョンを返します。
* `gtr(version, range)`:範囲内で有効なすべてのバージョンよりもバージョンが大きい場合は、`true` を返します。
* `ltr(version, range)`:範囲内で有効なすべてのバージョンよりもバージョンが小さい場合は、`true` を返します。
* `outside(version, range, hilo)`:バージョンが範囲外 (大きい方または小さい方) にある場合は、true を返します。  `hilo` 引数は文字列 `'>'` または `'<'` である必要があります  (これは、`gtr` または `ltr` によって呼び出される関数です)。
* `intersects(range)`:いずれかの範囲比較演算子が交差する場合は、true を返します。

範囲は連続していない可能性があるため、バージョンが範囲より大きくなく、範囲より小さくもなく、"*かつ*" 範囲を満たさない可能性があることに注意してください。  たとえば、範囲 `1.2 <1.2.9 || >2.0.0` には `1.2.9` から `2.0.0` までの穴があるため、バージョン `1.2.10` は範囲より大きくなく (より大きい `2.0.1` では満たされる)、範囲より小さくもなく (より小さい `1.2.8` では満たされる)、範囲を満たすこともありません。

バージョンが範囲を満たすか満たさないかを確認するには、`satisfies(version, range)` 関数を使用します。

### <a name="coercion"></a>強制型変換

* `coerce(version)`:可能であれば、文字列を semver に強制的に変換します。

これは、非 semver 文字列から semver への非常に寛大な翻訳を提供することを目的としています。 文字列内の最初の数字を検索し、許容される最大長 (256 文字) まで、少なくとも部分的な semver (例: `1`、`1.2`、`1.2.3`) を満たす残りのすべての文字を消費します。  より長いバージョンは単純に切り捨てられます (`4.6.3.9.2-alpha2` は `4.6.3` になります)。  周囲のテキストはすべて無視されます (`v3.4 replaces v3.3.1` は `3.4.0` になります)。  数字を含まないテキストのみが強制変換に失敗します (`version one` は無効です)。  強制変換の対象になる semver コンポーネントの最大長は 16 文字です。長いコンポーネントは無視されます (`10000000000000000.4.7.4` は `4.7.4` になります)。  すべての semver コンポーネントの最大値は `Number.MAX_SAFE_INTEGER || (2**53 - 1)` です。それより大きい値のコンポーネントは無効です (`9999999999999999.4.7.4` は無効である可能性があります)。
