---
ms.openlocfilehash: bd96d4c9278b37a2a3626abd3bd91dd20a15e2e1
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052859"
---
<a name="https-proxy-agent"></a>https-proxy-agent
================
### <a name="an-https-proxy-httpagent-implementation-for-https"></a>HTTPS の HTTP プロキシ `http.Agent` 実装
[![ビルドの状況](https://github.com/TooTallNate/node-https-proxy-agent/workflows/Node%20CI/badge.svg)](https://github.com/TooTallNate/node-https-proxy-agent/actions?workflow=Node+CI)

このモジュールは、指定された HTTP または HTTPS プロキシ サーバーに接続する `http.Agent` 実装を提供し、組み込み `https` モジュールで使用できます。

具体的には、この `Agent` 実装は中継の "プロキシ" サーバーに接続し、接続先サーバーへの直接の TCP 接続を開くようプロキシに指示する [CONNECT HTTP メソッド][CONNECT]を発行します。

このエージェントは CONNECT HTTP メソッドを実装するため、プロキシ (つまり WebSocket) 経由で接続するときにこのメソッドを使用する他のプロトコルでも動作します。
詳細については、下記の「例」のセクションを参照してください。


<a name="installation"></a>インストール
------------

`npm` を使用したインストール:

``` bash
$ npm install https-proxy-agent
```


<a name="examples"></a>例
--------

#### <a name="https-module-example"></a>`https` モジュールの例

``` js
var url = require('url');
var https = require('https');
var HttpsProxyAgent = require('https-proxy-agent');

// HTTP/HTTPS proxy to connect to
var proxy = process.env.http_proxy || 'http://168.63.76.32:3128';
console.log('using proxy server %j', proxy);

// HTTPS endpoint for the proxy to connect to
var endpoint = process.argv[2] || 'https://graph.facebook.com/tootallnate';
console.log('attempting to GET %j', endpoint);
var options = url.parse(endpoint);

// create an instance of the `HttpsProxyAgent` class with the proxy server information
var agent = new HttpsProxyAgent(proxy);
options.agent = agent;

https.get(options, function (res) {
  console.log('"response" event!', res.headers);
  res.pipe(process.stdout);
});
```

#### <a name="ws-websocket-connection-example"></a>`ws` WebSocket 接続の例

``` js
var url = require('url');
var WebSocket = require('ws');
var HttpsProxyAgent = require('https-proxy-agent');

// HTTP/HTTPS proxy to connect to
var proxy = process.env.http_proxy || 'http://168.63.76.32:3128';
console.log('using proxy server %j', proxy);

// WebSocket endpoint for the proxy to connect to
var endpoint = process.argv[2] || 'ws://echo.websocket.org';
var parsed = url.parse(endpoint);
console.log('attempting to connect to WebSocket %j', endpoint);

// create an instance of the `HttpsProxyAgent` class with the proxy server information
var options = url.parse(proxy);

var agent = new HttpsProxyAgent(options);

// finally, initiate the WebSocket connection
var socket = new WebSocket(endpoint, { agent: agent });

socket.on('open', function () {
  console.log('"open" event!');
  socket.send('hello world');
});

socket.on('message', function (data, flags) {
  console.log('"message" event! %j %j', data, flags);
  socket.close();
});
```

<a name="api"></a>API
---

### <a name="new-httpsproxyagentobject-options"></a>新しい HttpsProxyAgent (Object オプション)

この `HttpsProxyAgent` クラスは、HTTPS または WebSocket 要求をプロキシ経由にするために、指定された "HTTP(s) プロキシ サーバー" に接続する `http.Agent` サブクラスを実装します。 これは、[HTTP `CONNECT` メソッド][CONNECT]を使って実現されます。

`options` 引数には、使用するプロキシ サーバーの文字列 URI、または、より具体的なプロパティを持つ "options" オブジェクトを指定できます。

  * `host` - 文字列 - 接続先のプロキシ ホスト (`hostname` を使用する場合もあります)。 必須。
  * `port` - 数値 - 接続先のプロキシ ポート。 必須。
  * `protocol` - 文字列 - `https:` の場合は、TLS を使用してプロキシに接続します。
  * `headers` - オブジェクト - HTTP CONNECT メソッドで送信される追加の HTTP ヘッダー。
  * 指定されたその他のオプションは、`net.connect()`/`tls.connect()` 関数に渡されます。


<a name="license"></a>ライセンス
-------

(MIT ライセンス)

Copyright (c) 2013 Nathan Rajlich &lt;nathan@tootallnate.net&gt;

以下に定める条件に従って、本ソフトウェアおよび関連文書ファイルのコピー (以下、''ソフトウェア'') を取得したすべての人物に対して、ソフトウェアのコピーを使用、コピー、修正、結合、発行、配布、サブライセンス、または販売すること、およびソフトウェアの供給先がこれらを行うことを許可する無制限の権利も含めて、本ソフトウェアを制限なしで扱う許可を無償で与えます。

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

ソフトウェアは ''現状のまま'' で提供され、明示的または暗黙的にかかわらず、市販性、特定用途への適合性、および権利侵害がないことも含めて、何らかの保証が提供されることはありません。
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

[CONNECT]: http://en.wikipedia.org/wiki/HTTP_tunnel#HTTP_CONNECT_Tunneling
