---
ms.openlocfilehash: 6e941e3321fd7027073be094bebb5c8d7b449230
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "145884716"
---
# <a name="upgrade-guide"></a>アップグレード ガイド

### <a name="015x---0160"></a>0.15.x -> 0.16.0

#### <a name="promise-type-declarations"></a>`Promise` 型宣言

`Promise` 型宣言は、組み込みの型宣言を優先して、axios 型から削除されました。 `ES5` をターゲットとする TypeScript プロジェクトで axios を使用する場合は、必ず `es2015.promise` lib を含めてください。 詳細については、[こちらの投稿](https://blog.mariusschulz.com/2016/11/25/typescript-2-0-built-in-type-declarations)をご覧ください。

### <a name="013x---0140"></a>0.13.x -> 0.14.0

#### <a name="typescript-definitions"></a>TypeScript 定義

axios TypeScript の定義は、axios API と一致するように更新され、ES2015 モジュール構文を使用します。

TypeScript で axios をインポートするには、次の `import` ステートメントを使用してください。

```typescript
import axios from 'axios';

axios.get('/foo')
  .then(response => console.log(response))
  .catch(error => console.log(error));
```

#### <a name="agent-config-option"></a>`agent` 構成オプション

`agent` 構成オプションは、2 つの新しいオプション (`httpAgent` と `httpsAgent`) に置き換えられました。 代わりにこれらを使用してください。

```js
{
  // Define a custom agent for HTTP
  httpAgent: new http.Agent({ keepAlive: true }),
  // Define a custom agent for HTTPS
  httpsAgent: new https.Agent({ keepAlive: true })
}
```

#### <a name="progress-config-option"></a>`progress` 構成オプション

`progress` 構成オプションは、`onUploadProgress` および `onDownloadProgress` オプションに置き換えられました。

```js
{
  // Define a handler for upload progress events
  onUploadProgress: function (progressEvent) {
    // ...
  },

  // Define a handler for download progress events
  onDownloadProgress: function (progressEvent) {
    // ...
  }
}
```

### <a name="012x---0130"></a>0.12.x -> 0.13.0

`0.13.0` リリースには、カスタム アダプターとエラー処理に対するいくつかの変更が含まれています。

#### <a name="error-handling"></a>エラー処理

このリリースより前では、エラーは、状態コードが正しくないサーバー応答または実際の `Error` である可能性があります。 このリリースでは、Promise は常に `Error` で拒否されます。 応答が受信された場合は、`Error` に応答も含まれます。

```js
axios.get('/user/12345')
  .catch((error) => {
    console.log(error.message);
    console.log(error.code); // Not always specified
    console.log(error.config); // The config that was used to make the request
    console.log(error.response); // Only available if response was received from the server
  });
```

#### <a name="request-adapters"></a>要求アダプター

このリリースでは、要求アダプターの動作に関するいくつかの点が変更されます。 独自のカスタム アダプターを使用している場合は、注意してください。

1. 応答トランスフォーマーがアダプターの外部で呼び出されるようになりました。
2. 要求アダプターは、`Promise` を返します。

これは、応答データで `transformData` を呼び出す必要がなくなったことを意味します。 また、アダプターで `resolve` と `reject` を引数として受け取ることもなくなります。

以前のコード:

```js
function myAdapter(resolve, reject, config) {
  var response = {
    data: transformData(
      responseData,
      responseHeaders,
      config.transformResponse
    ),
    status: request.status,
    statusText: request.statusText,
    headers: responseHeaders
  };
  settle(resolve, reject, response);
}
```

新しいコード:

```js
function myAdapter(config) {
  return new Promise(function (resolve, reject) {
    var response = {
      data: responseData,
      status: request.status,
      statusText: request.statusText,
      headers: responseHeaders
    };
    settle(resolve, reject, response);
  });
}
```

詳細については、関連するコミットを参照してください。
- [応答トランスフォーマー](https://github.com/axios/axios/commit/10eb23865101f9347570552c04e9d6211376e25e)
- [要求アダプター Promise](https://github.com/axios/axios/commit/157efd5615890301824e3121cc6c9d2f9b21f94a)

### <a name="05x---060"></a>0.5.x -> 0.6.0

`0.6.0` リリースには主にバグ修正が含まれていますが、アップグレード時に注意すべき点がいくつかあります。

#### <a name="es6-promise-polyfill"></a>ES6 Promise ポリフィル

`0.6.0` リリース ES6 まで、`Promise` は [es6-promise](https://github.com/jakearchibald/es6-promise) を使用してポリフィル化されていました。 このリリースでは、ポリフィルが削除されたので、環境で必要な場合は自分で提供する必要があります。

```js
require('es6-promise').polyfill();
var axios = require('axios');
```

これにより、グローバル環境がポリフィル化され、1 回だけ実行する必要があります。

#### `axios.success`/`axios.error`

`success` および `error` エイリアスは、[0.4.0](https://github.com/axios/axios/blob/master/CHANGELOG.md#040-oct-03-2014) で非推奨になりました。 このリリースの時点では、完全に削除されています。 代わりに、それぞれ `axios.then` と `axios.catch` を使用してください。

```js
axios.get('some/url')
  .then(function (res) {
    /* ... */
  })
  .catch(function (err) {
    /* ... */
  });
```

#### <a name="umd"></a>UMD

AMD、CommonJS、グローバル ビルドに付属していた以前のバージョンの axios。 これはすべて 1 つの UMD ビルドにまとめられました。

```js
// AMD
require(['bower_components/axios/dist/axios'], function (axios) {
  /* ... */
});

// CommonJS
var axios = require('axios/dist/axios');
```
