---
ms.openlocfilehash: 05bea0332c8376e66d4aed62eab42a50c744536d
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052627"
---
# <a name="microsoft-authentication-library-for-node-msal-node"></a>ノード用 Microsoft Authentication Library (msal-node)

[![npm バージョン](https://img.shields.io/npm/v/@azure/msal-node.svg?style=flat)](https://www.npmjs.com/package/@azure/msal-node/)[![npm バージョン](https://img.shields.io/npm/dm/@azure/msal-node.svg)](https://nodei.co/npm/@azure/msal-node/)[![カバレッジ状態](https://coveralls.io/repos/github/AzureAD/microsoft-authentication-library-for-js/badge.svg?branch=dev)](https://coveralls.io/github/AzureAD/microsoft-authentication-library-for-js?branch=dev)

| <a href="https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa" target="_blank">はじめに</a> | <a href="https://aka.ms/aaddevv2" target="_blank">AAD ドキュメント</a> | <a href="https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_node.html" target="_blank">ライブラリ リファレンス</a> |
| --- | --- | --- |

現在、`msal-node` は開発中です。プロジェクトの進捗状況は、[ここで](https://github.com/AzureAD/microsoft-authentication-library-for-js/projects/4)追跡してください。 このドキュメントも進行中であり、`alpha` パッチのリリースに伴い変更される予定です。 **運用環境で、これを使用することは、まだお勧めしません**。

1. [バージョン情報](#about)
2. [FAQ](#faq)
3. [リリース](#releases)
4. [前提条件](#prerequisites)
5. [インストール](#installation)
6. [使用方法](#usage)
7. [サンプル](#samples)
8. [ライブラリのビルド](#build-and-test)
9. [セキュリティ レポート](#security-reporting)
10. [ライセンス](#license)
11. [行動規範](#we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct)

## <a name="about"></a>詳細

MSAL Node を使用すると、アプリケーションは[、Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview) の職場および学校アカウント (AAD)、Microsoft 個人アカウント (MSA)、Facebook、Google、LinkedIn、Microsoft アカウントなどのソーシャル ID プロバイダーを使用して、[Azure AD B2C](https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers) サービス経由でユーザーを認証できます。 また、アプリは、[Microsoft Graph](https://www.microsoft.com/enterprise) などの [Microsoft Cloud](https://graph.microsoft.io) サービスにアクセスするためのトークンを取得することもできます。


### <a name="oauth20-grant-types-supported"></a>許可の種類として、OAuth2.0 がサポートされています。

現在のアルファ バージョンでは、次のトークン取得方法がサポートされています。

#### <a name="public-client"></a>パブリック クライアント:
- [PKCE](https://oauth.net/2/pkce/) を使用した[承認コード付与](https://oauth.net/2/grant-types/authorization-code/)
- [デバイス コード付与](https://oauth.net/2/grant-types/device-code/)
- [更新トークン付与](https://oauth.net/2/grant-types/refresh-token/)
- [サイレント フロー](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)

#### <a name="confidential-client"></a>機密クライアント:
- クライアント資格情報を使用した[承認コード付与](https://oauth.net/2/grant-types/authorization-code/)
- [更新トークン付与](https://oauth.net/2/grant-types/refresh-token/)
- [サイレント フロー](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)
- [クライアント資格情報付与](https://oauth.net/2/grant-types/client-credentials/)
- [On-Behalf-Of フロー](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow)

**[近日公開予定]** 今後、次のサポートを追加する予定です。
- [統合 Windows 認証フロー](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#integrated-windows-authentication)
- [ユーザー名とパスワード フロー](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#usernamepassword)

Microsoft 認証ライブラリで一般的にサポートされているさまざまな付与の種類の詳細については、[こちら](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows)を参照してください。

### <a name="scenarios-supported"></a>サポートされるシナリオ:

このライブラリでサポートされるシナリオは次のとおりです。
- Web API を呼び出すデスクトップ アプリ
- Web API を呼び出す Web アプリ
- Web API を呼び出す Web API
- デーモン アプリ

シナリオとそのそれぞれに対応する認証フローの詳細については、[こちら](https://docs.microsoft.com/en-us/azure/active-directory/develop/authentication-flows-app-scenarios)を参照してください。

## <a name="faq"></a>よく寄せられる質問

[こちら](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/faq.md)を参照してください。

## <a name="prerequisites"></a>前提条件

`@azure/msal-node` を使用する前に、Azure portal でご利用のアプリを登録する必要があります。

- [アプリの登録](https://docs.microsoft.com/en-us/graph/auth-register-app-v2)

## <a name="installation"></a>インストール

### <a name="via-npm"></a>NPM 経由:
```javascript
npm install @azure/msal-node
```
##  <a name="usage"></a>使用

### <a name="msal-basics"></a>MSAL の基本
- [パブリック クライアントと機密クライアントの相違点を理解する](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-applications)
- [パブリック クライアント アプリケーションを初期化する](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-public-client-application.md)
- [機密クライアント アプリケーションを初期化する](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-confidential-client-application.md)
- [構成](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/configuration.md)
- [Request](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/request.md)
- [Response](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/response.md)

## <a name="samples"></a>サンプル
MSAL Node を使用してトークンを取得する複数の[サンプル](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples)がリポジトリに含まれています。 これらのサンプルは現在、手動テストに使用されていて、ベスト プラクティスの参照を目的としたものではないため、よく見極めて、このコードを運用アプリケーションに盲目的にコピーしないでください。

- [auth-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/auth-code): OAuth2.0 承認コード フローを使用した Express アプリ。
- [device-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/device-code):OAuth 2.0 デバイス コード フローを使用したコマンド ライン アプリ。
- [refresh-token](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/refresh-token): OAuth 2.0 更新フローを使用したコマンド ライン アプリ。
- [silent-flow](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/silent-flow):OAuth2.0 承認コード フローを使用してトークンを取得し、トークン キャッシュに格納する Express アプリと、トークン キャッシュ内のトークンを使用するサイレント フロー。
- [client-credentials](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/client-credentials):Oauth 2.0 クライアント資格情報付与を使用してトークンを取得するデーモン アプリ。
- [on-behalf-of](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/on-behalf-of): Web アプリケーションでは、Oauth 2.0 認証コード フローを使用して Web API のトークンを取得します。 Web API ではトークンを検証し、Web アプリケーションで認証されたユーザーの代わりに Microsoft Graph を呼び出します。
- [msal-node-extensions](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/samples/msal-node-extensions):承認コード フローを使用してトークンを取得し、[msal-extensions](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/) ライブラリを使用して MSAL インメモリ トークン キャッシュをディスクに書き込みます。

## <a name="build-and-test"></a>ビルドとテストを行います。

- [lerna](https://github.com/lerna/lerna) がインストールされていない場合は、`npm install -g lerna` を実行します
- `microsoft-authentication-library-for-js.git` 内の任意の場所から `lerna bootstrap` を実行します。
- `microsoft-authentication-library-for-js/lib/msal-common` に移動して、`npm run build` を実行する
- `microsoft-authentication-library-for-js/lib/msal-node` に移動して、`npm run build` を実行する

```javascript
// to link msal-node and msal-common packages
lerna bootstrap

// Change to the msal-node package directory
cd lib/msal-common/

// To run build only for node package
npm run build

// Change to the msal-node package directory
cd lib/msal-node/

// To run build only for node package
npm run build
```

### <a name="local-development"></a>ローカル開発
役に立つと思われるコマンドの一覧を次に示します。

#### `npm run build:modules:watch`
開発/ウォッチ モードでプロジェクトを実行します。 プロジェクトは変更時に再構築されます。 TSDX には便利なように特別なロガーが用意されています。 エラー メッセージは、互換性のために VS Code の [問題] タブできれいに印刷およびフォーマットされます。編集を行うと、ライブラリが再構築されます。

#### `npm run build`
パッケージを `dist` フォルダーにバンドルします。
パッケージは最適化され、ロールアップを使用して複数のフォーマット (CommonJS、UMD、および ES モジュール) にロールアップされます。

#### `lerna bootstrap`
プロジェクトを開発/ウォッチ モードで実行している場合、または `msal-common` で変更を加えてプロジェクト全体にそれを反映させる必要がある場合は、`lerna bootstrap` を実行してすべてのシンボルをリンクしてください。 `npm install` によってすべてのコードのリンクが解除されるので、インストール後に `lerna bootstrap` を実行することをお勧めします。

#### `npm run lint`
Prettier で eslint を実行する

#### <a name="npm-test-npm-run-testcoverage-npm-run-testwatch"></a>`npm test`, `npm run test:coverage`, `npm run test:watch`
対話型モードでテスト ウォッチャー (Jest) を実行します。
既定では、前回のコミット以降に変更されたファイルに関連するテストのみが実行されます。
フラグ --coverage を追加してコード カバレッジを生成します。 追加のセットアップは必要ありません。 Jest では、テストされていないファイルを含むプロジェクト全体からコード カバレッジ情報を収集できます。

## <a name="security-reporting"></a>セキュリティ レポート

ライブラリまたはサービスでセキュリティに関する問題が見つかった場合は、それを、できるだけ詳細に [secure@microsoft.com](mailto:secure@microsoft.com) に報告してください。 お客様の提出物は、[Microsoft Bounty](http://aka.ms/bugbounty) プログラムを通じて報奨金の対象となる場合があります。 GitHub の Issue またはその他のいずれのパブリック サイトにも、セキュリティの問題を投稿しないでください。 情報が届きましたら、すぐにこちらからお客様に連絡します。 セキュリティの問題が発生したときに通知を受け取ることをお勧めします。そのためには、[このページ](https://technet.microsoft.com/security/dd252948)にアクセスし、セキュリティ アドバイザリ通知を受信登録してください。

## <a name="license"></a>ライセンス

Copyright (c) Microsoft Corporation.  All rights reserved. Licensed under the MIT License.

## <a name="we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct"></a>Microsoft は、Microsoft オープン ソースの倫理規定を尊重し、遵守します

このプロジェクトは、[Microsoft のオープン ソースの倫理規定](https://opensource.microsoft.com/codeofconduct/)を採用しています。 詳細については[論理規定についてのよくある質問](https://opensource.microsoft.com/codeofconduct/faq/)をご覧ください。また、追加の質問やコメントがある場合は[opencode@microsoft.com](mailto:opencode@microsoft.com)にお問い合わせください。

