---
ms.openlocfilehash: 5f4ff1937c647160a418ca9c807267dc22e5e09f
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052667"
---
注:既定のブランチの名前が変更されました。
master は main という名前になりました

ローカル クローンがある場合は、以下を実行して更新できます。

```shell
git branch -m master main
git fetch origin
git branch -u origin/main main
```

# <a name="node-addon-api-module"></a>**node-addon-api モジュール**
このモジュールには、C++ を使う場合に Node.js によって提供される C ベースの [Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html) の使用を簡略化する、**ヘッダー専用の C++ ラッパー クラス** が含まれています。 C++ オブジェクト モデルと例外処理セマンティクスが低オーバーヘッドで提供されます。

アドオンを実装するための 3 つのオプションがあります (内部 V8、libuv、Node.js ライブラリの Node-API、nan、または直接使用)。 Node.js コアの [C/C++ アドオン](https://nodejs.org/dist/latest/docs/api/addons.html)で説明されているように、Node-API によって公開されていない機能に直接アクセスする必要がない限り、Node-API を使用します。 Node-API の詳細については、「[Node-API を使用した C/C++ アドオン](https://nodejs.org/dist/latest/docs/api/n-api.html)」を参照してください。

Node-API は、ネイティブ アドオンをビルドするために Node.js によって提供される ABI が安定した C インターフェイスです。 基になる JavaScript ランタイム (V8 や ChakraCore など) から独立しており、Node.js 自体の一部として維持されます。 基になる JavaScript エンジンの変更からネイティブ アドオンを分離し、1 つのバージョン用にコンパイルされたモジュールを再コンパイルせずに新しいバージョンの Node.js で実行できるようにすることを目的としています。

Node.js の一部ではない `node-addon-api` モジュールは、Node-API によって提供される安定した API のみに依存するインライン コードのみで構成されているため、Node-API の利点が保たれます。 したがって、node-addon-api を使用する 1 つのバージョンの Node.js に対してビルドされたモジュールは、新しいバージョンの Node.js でリビルドしなくても実行されるはずです。

(`#include <uv.h>` を使用してプロジェクトに含まれる) `libuv` などの ''*他の*'' Node.js インターフェイスは、Node.js メジャー バージョン間で ABI が安定しないことに注意することが重要です。 したがって、アドオンでは Node-API または `node-addon-api` を排他的に使用し、Node-API の実装を含むバージョンの Node.js (アクティブな LTS バージョンの Node.js を意味する) に対してビルドし、Node.js メジャー バージョン間で ABI の安定性を活用する必要があります。 Node.js では、ABI の安定性全般の詳細な説明と、特に Node-API ABI の安定性の保証を含む [ABI 安定性ガイド][]が提供されます。

新しい API を Node-API に追加した場合、それらの新しい API のラッパーを提供するために node-addon-api を更新する必要があります。 このため、node-addon-api では、呼び出し元が基になる Node-API ハンドルを取得できるようにするメソッドが提供されているため、Node-API への直接呼び出しと、node-addon-api によって提供されるオブジェクトとメソッドの使用を併用できます。 たとえば、node-addon-api でまだラッパーが提供されていない API を使用できるようにするためです。

node-addon-api によって公開される API は、通常、JavaScript 値の作成と操作に使用されます。 概念と操作は通常、**ECMA262 言語仕様** で指定されたアイデアにマップされます。

[Node-API リソース](https://nodejs.github.io/node-addon-examples/) では、Node-API と node-addon-api を使い始めたばかりの開発者にとって、優れた方向性とヒントが提供されます。

- **[設定](#setup)**
- **[API ドキュメント](#api)**
- **[例](#examples)**
- **[テスト](#tests)**
- **[ネイティブ アドオンに関するその他のリソースと情報](#resources)**
- **[バッジ](#badges)**
- **[行動規範](CODE_OF_CONDUCT.md)**
- **[共同作成者](#contributors)**
- **[ライセンス](#license)**

## <a name="current-version-321"></a>**現在のバージョン:3.2.1**

(完全な変更ログについては、[CHANGELOG.md](CHANGELOG.md) を参照してください)

[![NPM](https://nodei.co/npm/node-addon-api.png?downloads=true&downloadRank=true)](https://nodei.co/npm/node-addon-api/) [![NPM](https://nodei.co/npm-dl/node-addon-api.png?months=6&height=1)](https://nodei.co/npm/node-addon-api/)

<a name="setup"></a>

node-addon-api は [Node-API](https://nodejs.org/api/n-api.html) に基づいており、さまざまな Node-API バージョンの使用がサポートされています。
これにより、それを使用してビルドされたアドオンは、ターゲットの Node-API バージョンをサポートする Node.js バージョンで実行できます。
**しかし**、node-addon-api サポート モデルは、アクティブな LTS Node.js バージョンのみをサポートするためのものです。 これは、サービスが提供されなくなった Node.js LTS バージョンのサポートを終了する新しいメジャーが毎年存在することを意味します。

node-addon-api の現在のバージョンでサポートされている最も古い Node.js バージョンは、Node.js 10.x です。

## <a name="setup"></a>セットアップ
  - [インストールと使用方法](doc/setup.md)
  - [node-gyp](doc/node-gyp.md)
  - [cmake-js](doc/cmake-js.md)
  - [変換ツール](doc/conversion-tool.md)
  - [チェッカー ツール](doc/checker-tool.md)
  - [Generator](doc/generator.md)
  - [プレビルド ツール](doc/prebuild_tools.md)

<a name="api"></a>

### <a name="api-documentation"></a>**API ドキュメント**

node-addon-api のドキュメントを以下に示します。

 - [完全なクラスの階層](doc/hierarchy.md)
 - [アドオンの構造](doc/addon.md)
 - データ型:
    - [Env](doc/env.md)
    - [CallbackInfo](doc/callbackinfo.md)
    - [参照](doc/reference.md)
    - [Value](doc/value.md)
        - [名前](doc/name.md)
            - [記号](doc/symbol.md)
            - [String](doc/string.md)
        - [Number](doc/number.md)
        - [日付](doc/date.md)
        - [BigInt](doc/bigint.md)
        - [Boolean](doc/boolean.md)
        - [外部](doc/external.md)
        - [Object](doc/object.md)
            - [Array](doc/array.md)
            - [ObjectReference](doc/object_reference.md)
    - [PropertyDescriptor](doc/property_descriptor.md)
    - [Function](doc/function.md)
        - [FunctionReference](doc/function_reference.md)
    - [ObjectWrap](doc/object_wrap.md)
        - [ClassPropertyDescriptor](doc/class_property_descriptor.md)
    - [バッファー](doc/buffer.md)
    - [ArrayBuffer](doc/array_buffer.md)
    - [TypedArray](doc/typed_array.md)
      - [TypedArrayOf](doc/typed_array_of.md)
    - [DataView](doc/dataview.md)
 - [エラー処理](doc/error_handling.md)
    - [エラー](doc/error.md)
      - [TypeError](doc/type_error.md)
      - [RangeError](doc/range_error.md)
 - [オブジェクトの有効期間の管理](doc/object_lifetime_management.md)
    - [HandleScope](doc/handle_scope.md)
    - [EscapableHandleScope](doc/escapable_handle_scope.md)
 - [メモリ管理](doc/memory_management.md)
 - [非同期操作](doc/async_operations.md)
    - [AsyncWorker](doc/async_worker.md)
    - [AsyncContext](doc/async_context.md)
    - [AsyncWorker バリアント](doc/async_worker_variants.md)
 - [スレッドセーフ関数](doc/threadsafe.md)
    - [ThreadSafeFunction](doc/threadsafe_function.md)
    - [TypedThreadSafeFunction](doc/typed_threadsafe_function.md)
 - [Promise](doc/promises.md)
 - [バージョン管理](doc/version_management.md)

<a name="examples"></a>

### <a name="examples"></a>**使用例**

**node-addon-api** をご利用になるのは初めてですか? **[例](https://github.com/nodejs/node-addon-examples)** を見てみましょう

- **[Hello World](https://github.com/nodejs/node-addon-examples/tree/HEAD/1_hello_world/node-addon-api)**
- **[関数に引数を渡す](https://github.com/nodejs/node-addon-examples/tree/HEAD/2_function_arguments/node-addon-api)**
- **[コールバック](https://github.com/nodejs/node-addon-examples/tree/HEAD/3_callbacks/node-addon-api)**
- **[オブジェクト ファクトリ](https://github.com/nodejs/node-addon-examples/tree/HEAD/4_object_factory/node-addon-api)**
- **[関数ファクトリ](https://github.com/nodejs/node-addon-examples/tree/HEAD/5_function_factory/node-addon-api)**
- **[C++ オブジェクトのラップ](https://github.com/nodejs/node-addon-examples/tree/HEAD/6_object_wrap/node-addon-api)**
- **[ラップされたオブジェクトのファクトリ](https://github.com/nodejs/node-addon-examples/tree/HEAD/7_factory_wrap/node-addon-api)**
- **[ラップされたオブジェクトを渡す](https://github.com/nodejs/node-addon-examples/tree/HEAD/8_passing_wrapped/node-addon-api)**

<a name="tests"></a>

### <a name="tests"></a>**テスト**

**node-addon-api** テストを実行するには、次のようにします。

```
npm install
npm test
```

API の非推奨部分のテストを回避するには、以下を実行します
```
npm install
npm test --disable-deprecated
```

特定のバージョンの Node-API をターゲットとするテストを実行するには、以下を実行します
```
npm install
export NAPI_VERSION=X
npm test --NAPI_VERSION=X
```

ここで X は、ターゲットとする Node-API のバージョンです。

### <a name="debug"></a>**デバッグ**

`--debug` オプションを使用して **node-addon-api** テストを実行するには:

```
npm run-script dev
```

より高速なビルドが必要な場合は、次のオプションを使用できます。

```
npm run-script dev:incremental
```

**[テスト スイート](https://github.com/nodejs/node-addon-api/tree/HEAD/test)** を見てインスピレーションを得ましょう

### <a name="benchmarks"></a>**ベンチマーク**

次のコマンドを使用して、使用可能なベンチマークを実行できます。

```
npm run-script benchmark
```

ベンチマークの実行と追加の詳細については、[benchmark/README.md](benchmark/README.md) を参照してください。

<a name="resources"></a>

### <a name="more-resource-and-info-about-native-addons"></a>**ネイティブ アドオンに関するその他のリソースと情報**
- **[C++ アドオン](https://nodejs.org/dist/latest/docs/api/addons.html)**
- **[Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)**
- **[Node-API - ネイティブ モジュール用の次世代 Node API](https://youtu.be/-Oniup60Afs)**
- **[Realm JavaScript を NAN から Node-API に移行する方法](https://developer.mongodb.com/article/realm-javascript-nan-to-n-api)**

node-addon-api の核となる使命は C++ ラッパーとしてプレーンな C Node-API を公開することであるため、n-api/node-addon-api を使用して Node.js アドオンを開発するためのより便利なパターンを提供する n-api/node-addon-api を促進するツールは、スタンドアロン パッケージとして NPM に発行できます。 また、コミュニティにより多くの可視性を提供するために、このようなパッケージに `node-addon-api` でタグ付けすることをお勧めします。

NPM 検索へのクイック リンク: [keywords:node-addon-api](https://www.npmjs.com/search?q=keywords%3Anode-addon-api)。

<a name="other-bindings"></a>

### <a name="other-bindings"></a>**その他のバインド**

- **[napi-rs](https://napi.rs)** - (`Rust`)

<a name="badges"></a>

### <a name="badges"></a>**バッジ**

モジュールに必要な Node-API の最小バージョンを示すには、バッジを使用することをお勧めします。 これは、サポートされている Node.js メジャー バージョンを判断するのに役立ちます。 アドオン保守担当者は [Node-API サポート マトリックス][]を参照し、特定の Node-API バージョンを提供する Node.js バージョンを判断できます。 次のバッジを使用できます。

![Node-API v1 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v1%20Badge.svg)
![Node-API v2 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v2%20Badge.svg)
![Node-API v3 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v3%20Badge.svg)
![Node-API v4 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v4%20Badge.svg)
![Node-API v5 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v5%20Badge.svg)
![Node-API v6 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v6%20Badge.svg)
![Node-API v7 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v7%20Badge.svg)
![Node-API v8 バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v8%20Badge.svg)
![Node-API 試験版バッジ](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20Experimental%20Version%20Badge.svg)

## <a name="contributing"></a>**寄与**

コミュニティからの **node-addon-api** への投稿を歓迎します。
このモジュールの拡張に関する当社の哲学について詳しくは、[CONTRIBUTING.md](CONTRIBUTING.md) を参照してください。

<a name="contributors"></a>

## <a name="team-members"></a>チーム メンバー

### <a name="active"></a>アクティブ
| 名前                | GitHub のリンク                                           |
| ------------------- | ----------------------------------------------------- |
| Anna Henningsen     | [addaleax](https://github.com/addaleax)               |
| Chengzhong Wu       | [legendecas](https://github.com/legendecas)           |
| Gabriel Schulhof    | [gabrielschulhof](https://github.com/gabrielschulhof) |
| Jim Schlight        | [jschlight](https://github.com/jschlight)             |
| Michael Dawson      | [mhdawson](https://github.com/mhdawson)               |
| Kevin Eady          | [KevinEady](https://github.com/KevinEady)
| Nicola Del Gobbo    | [NickNaso](https://github.com/NickNaso)               |

### <a name="emeritus"></a>名誉
| 名前                | GitHub のリンク                                           |
| ------------------- | ----------------------------------------------------- |
| Arunesh Chandra     | [aruneshchandra](https://github.com/aruneshchandra)   |
| Benjamin Byholm     | [kkoopa](https://github.com/kkoopa)                   |
| Jason Ginchereau    | [jasongin](https://github.com/jasongin)               |
| Hitesh Kanwathirtha | [digitalinfinity](https://github.com/digitalinfinity) |
| Sampson Gao         | [sampsongao](https://github.com/sampsongao)           |
| Taylor Woll         | [boingoing](https://github.com/boingoing)             |

<a name="license"></a>

[MIT](./LICENSE.md) に基づき使用許諾

[ABI 安定性ガイド]: https://nodejs.org/en/docs/guides/abi-stability/
[Node-API サポート マトリックス]: https://nodejs.org/dist/latest/docs/api/n-api.html#n_api_n_api_version_matrix
