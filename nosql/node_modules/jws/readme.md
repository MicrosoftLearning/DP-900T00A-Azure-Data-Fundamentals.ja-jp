---
ms.openlocfilehash: 4d20fe9ebd12ad861676f14f1c8e66479fd1e481
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051116"
---
# <a name="node-jws-build-statushttptravis-ciorgbrianloveswordsnode-jws"></a>node-jws [![ビルドの状態](https://secure.travis-ci.org/brianloveswords/node-jws.svg)](http://travis-ci.org/brianloveswords/node-jws)

[JSON Web 署名](http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html)の実装。

これは、`draft-ietf-jose-json-web-signature-08` に対して開発され、X.509 証明書チェーンの署名または検証 (パッチも可) を **除く** 仕様全体が実装されています。

これらは同期的 (`jws.sign`、`jws.verify`) で、かつストリーミング (`jws.createSign`、`jws.createVerify`) API です。

# <a name="install"></a>[インストール]

```bash
$ npm install jws
```

# <a name="usage"></a>使用

## <a name="jwsalgorithms"></a>jws.ALGORITHMS

サポートされているアルゴリズムの配列。 次のアルゴリズムが現在サポートされています。

アルゴリズム パラメーター値 | デジタル署名または MAC アルゴリズム
----------------|----------------------------
HS256 | SHA-256 ハッシュ アルゴリズムを使用する HMAC
HS384 | SHA-384 ハッシュ アルゴリズムを使用する HMAC
HS512 | SHA-512 ハッシュ アルゴリズムを使用する HMAC
RS256 | SHA-256 ハッシュ アルゴリズムを使用する RSASSA
RS384 | SHA-384 ハッシュ アルゴリズムを使用する RSASSA
RS512 | SHA-512 ハッシュ アルゴリズムを使用する RSASSA
PS256 | SHA-256 ハッシュ アルゴリズムを使用する RSASSA-PSS
PS384 | SHA-384 ハッシュ アルゴリズムを使用する RSASSA-PSS
PS512 | SHA-512 ハッシュ アルゴリズムを使用する RSASSA-PSS
ES256 | P-256 曲線と SHA-256 ハッシュ アルゴリズムを使用する ECDSA
ES384 | P-384 曲線と SHA-384 ハッシュ アルゴリズムを使用する ECDSA
ES512 | P-521 曲線と SHA-512 ハッシュ アルゴリズムを使用する ECDSA
なし | デジタル署名または MAC 値は含まれません

## <a name="jwssignoptions"></a>jws.sign(options)

(同期) ヘッダーとペイロードの JSON Web 署名を返します。

オプション:

* `header`
* `payload`
* `secret` または `privateKey`
* `encoding` (省略可能、既定値は 'utf8')

`header` は、`alg` プロパティを持つオブジェクトである必要があります。 `header.alg` は、`jws.ALGORITHMS` で見つかった値である必要があります。 サポートされているアルゴリズムの表については、上記を参照してください。

`payload` がバッファーまたは文字列でない場合は、`JSON.stringify` を使用して文字列に強制変換されます。

例

```js
const signature = jws.sign({
  header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  secret: 'has a van',
});
```

## <a name="jwsverifysignature-algorithm-secretorkey"></a>jws.verify(signature, algorithm, secretOrKey)

(同期) 署名がシークレットまたはキーと一致するかどうかについて `true` または `false` を返します。

`signature` は JWS 署名です。 `header.alg` は、`jws.ALGORITHMS` で見つかった値である必要があります。
サポートされているアルゴリズムの表については、上記を参照してください。 `secretOrKey` は、HMAC アルゴリズムのシークレット、または RSA および ECDSA の PEM エンコードされた公開キーのいずれかを含む文字列またはバッファーです。

署名ヘッダーの `"alg"` 値は無視されることに注意してください。


## <a name="jwsdecodesignature"></a>jws.decode(signature)

(同期) JWS 署名のデコードされたヘッダー、デコードされたペイロード、および署名部分を返します。

3 つのプロパティを持つオブジェクトを返します。たとえば、次のものがあります。
```js
{ header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  signature: 'YOWPewyGHKu4Y_0M_vtlEnNlqmFOclqp4Hy6hVHfFT4'
}
```

## <a name="jwscreatesignoptions"></a>jws.createSign(options)

新しい SignStream オブジェクトを返します。

オプション:

* `header` (必須)
* `payload`
* `key` || `privateKey` || `secret`
* `encoding` (省略可能、既定値は 'utf8')

`header` 以外は、値が事前にわかっている場合は文字列またはバッファーを除くすべてのオプション。または便宜上ストリーム。
暗号化された秘密キーを使用する場合、`key`/`privateKey`/`secret` はオブジェクトである可能性もあります。[暗号化のドキュメント][encrypted-key-docs]を参照してください。

例:

```js

// This...
jws.createSign({
  header: { alg: 'RS256' },
  privateKey: privateKeyStream,
  payload: payloadStream,
}).on('done', function(signature) {
  // ...
});

// is equivalent to this:
const signer = jws.createSign({
  header: { alg: 'RS256' },
});
privateKeyStream.pipe(signer.privateKey);
payloadStream.pipe(signer.payload);
signer.on('done', function(signature) {
  // ...
});
```

## <a name="jwscreateverifyoptions"></a>jws.createVerify(options)

新しい VerifyStream オブジェクトを返します。

オプション:

* `signature`
* `algorithm`
* `key` || `publicKey` || `secret`
* `encoding` (省略可能、既定値は 'utf8')

値が事前にわかっている場合は文字列またはバッファーを除くすべてのオプション。または便宜上ストリーム。

例:

```js

// This...
jws.createVerify({
  publicKey: pubKeyStream,
  signature: sigStream,
}).on('done', function(verified, obj) {
  // ...
});

// is equivilant to this:
const verifier = jws.createVerify();
pubKeyStream.pipe(verifier.publicKey);
sigStream.pipe(verifier.signature);
verifier.on('done', function(verified, obj) {
  // ...
});
```

## <a name="class-signstream"></a>クラス:SignStream

完了すると、1 つのデータ イベント (計算された署名) を出力する `Readable Stream`。

### <a name="event-done"></a>イベント: 'done'
`function (signature) { }`

### <a name="signerpayload"></a>signer.payload

JWS ペイロードを受け取る `Writable Stream`。 コンストラクターに `payload` オプションを渡した場合は、使用 *しないでください*。

例:

```js
payloadStream.pipe(signer.payload);
```

### <a name="signersecretbrsignerkeybrsignerprivatekey"></a>signer.secret<br>signer.key<br>signer.privateKey

`Writable Stream`。 HMAC の JWS シークレット、または ECDSA と RSA の privateKey を受け取ります。 コンストラクターに `secret` または `key` オプションを渡した場合は、使用 *しないでください*。

例:

```js
privateKeyStream.pipe(signer.privateKey);
```

## <a name="class-verifystream"></a>クラス:VerifyStream

これは、1 つのデータ イベントを出力する `Readable Stream` イベントであり、その署名が有効であったかどうかの結果です。

### <a name="event-done"></a>イベント: 'done'
`function (valid, obj) { }`

`valid` は、署名が有効かどうかを示すブール値です。

### <a name="verifiersignature"></a>verifier.signature

JWS 署名を受け取る `Writable Stream`。 コンストラクターに `signature` オプションを渡した場合は、使用 *しないでください*。

### <a name="verifiersecretbrverifierkeybrverifierpublickey"></a>verifier.secret<br>verifier.key<br>verifier.publicKey

公開キーまたはシークレットを受け取る `Writable Stream`。 コンストラクターに `key` または `secret` オプションを渡した場合は、使用 *しないでください*。

# <a name="todo"></a>TODO

* 毎回 `{ alg: 'ES512' }` を使用してヘッダー オブジェクトを定義する必要はなく、アルゴリズムを定義するための便利なオプションまたは API があるはずです。

* X.509 のサポート、ugh

# <a name="license"></a>ライセンス

MIT

```
Copyright (c) 2013-2015 Brian J. Brennan

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```

[encrypted-key-docs]: https://nodejs.org/api/crypto.html#crypto_sign_sign_private_key_output_format
