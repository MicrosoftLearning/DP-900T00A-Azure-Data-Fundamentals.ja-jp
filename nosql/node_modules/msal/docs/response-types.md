---
ms.openlocfilehash: 5bfa32f8a7b06cf792c38a0dd2fa1f86595e660c
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "145884267"
---
# <a name="response-types"></a>応答の種類

> :警告:このドキュメントは暗黙的に型指定されたフロー付与タイプを実装している `msal@1.x` にのみ適用されます。 認可コードのフロー付与タイプについては、[msal-browser](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser) ライブラリを使用してください。

## <a name="quick-reference"></a>クイック リファレンス

> このセクションでは、詳細には触れずに、このドキュメントが扱う主要なポイントの概要について説明します。 `msal@1.x` の応答の種類の機能と動作について、より明確な説明や情報が必要な場合は、このドキュメントの残りの部分をお読みください。

`msal@1.x` が `Response Types` を決定し処理する方法の主要なポイントは次のとおりです。

1. `loginRedirect`、`loginPopup`、`ssoSilent` は常に ID トークンを返し、`id_token` の `response_type` を持ちます。
2. `acquireToken` 要求は、`openid` または `profile` が要求スコープに含まれている場合、常に ID トークンを返します。
3. `acquireToken` 要求は、`resource scope` が要求された場合、常にアクセス トークンを返します。

応答の種類の決定方法と、それが何に使われるかという根拠や意義についてもっと知りたい場合は、このドキュメントの残りの部分をお読みください。

## <a name="definition-and-types"></a>定義と種類
`msal@1.x` ライブラリは、OAuth 2.0 プロトコル仕様と OpenID Connect 仕様に準拠し、3 種類の `response types` を定義しサポートしています。

* token
* id_token
* id_token token

**`msal@1.x` ライブラリは、認可コード付与を実装していないため、`code` 応答の種類をサポートしていません。認可コード付与タイプの実装を検討している場合は、[msal-browser](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser) ライブラリを考慮してください。**

一覧にある応答の種類は、OAuth 2.0 HTTP 要求の `response_type` パラメーターに使用できる値です。 要求が有効である場合、このパラメーターは、`msal@1.x` がアクセスおよび ID トークンを要求した Secure Token Service (STS) からどのような種類のトークンが返されるかを決定します。

| 応答の種類 | 定義されている仕様 | 要求が成功した場合に期待されるトークンの種類 | アクション |
| ------------- | ----------------------------- | ------------------------------------------- | ------ |
| `token` |[OAuth 2.0](https://tools.ietf.org/html/rfc6749#section-3.1.1) | Access Token | 承認 |
| `id_token`| [OpenID Connect](https://openid.net/specs/openid-connect-core-1_0.html#Authentication) | ID トークン | 認証 |
|`id_token token`| [OpenID Connect](https://openid.net/specs/openid-connect-core-1_0.html#Authentication) | アクセス トークンと ID トークン | 認証と認可 |

**注:`msal@1.x` は OAuth 2.0 暗黙的フローのみを使っており、トークン受信に URL フラグメントを利用するため、URL の長さ制限に注意する必要があります。IE などのブラウザーでは URL の長さに制限があるため、アクセス トークンと ID トークンを同じ URL で取得すると、予期しない動作や誤った動作を引き起こす可能性があります。**

## <a name="response-type-configuration-and-behavior"></a>応答の種類の構成と動作

上記の `response_type` 属性を、直接構成することはできません。 ただし、`msal@1.x` がどの応答種類を設定するかを決定する方法を理解することは重要であり、そのため、開発者が各シナリオでどのような種類のトークンを想定できるのかを理解しておくことが重要です。 要求の `response_type` パラメーターを設定するときに考慮される要素は、次のとおりです。

1. 呼び出された `msal@1.x` API
2. 要求の構成に渡されたアカウントが、MSAL のキャッシュにあるアカウントと一致するかどうか
3. 認可の要求の構成オブジェクトの `scopes` 配列の内容。 `scopes` の構成についての詳細については、[Scope](/docs/scopes.md) のドキュメントを参照してください。

**重要な注意:ログイン API は、ユーザー ログイン (認証) を行うように設計されていることから、常に `response_type=id_token` を設定するようにします。**

ログイン API には次が含まれます。

* loginRedirect
* loginPopup
* ssoSilent

つまり、ユーザーをログインさせるために `loginRedirect` や `loginPopup` を呼び出す場合は常に、要求が成功した場合に ID トークンを受け取ることを想定する必要があります。

このセクションには、`login` と `acquireToken` の両方の API に関して、要求の構成を適切に結果の応答の種類にマップするクイック リファレンス表があります。

## <a name="quick-reference-tables"></a>クイック リファレンス表

### <a name="login-apis"></a>ログイン API

適用対象: `loginRedirect`、`loginPopup`、`ssoSilent`

| 入力スコープ | 渡されたアカウント | 応答の種類の結果 |
| ----------------- | ------------ | -------------------- |
| 任意のケース | 任意のケース | `id_token`|

### <a name="acquire-token-apis"></a>トークンを取得する API

適用対象: `acquireTokenRedirect`、`acquireTokenPopup`、`acquireTokenSilent`

* *"OIDC スコープ: `openid` および/または `profile` の任意の組み合わせ"*
* *"OIDC スコープのみ:OIDC スコープと同じだが、配列の中に他のスコープがないもの"*

| 入力スコープ | 渡されたアカウント | 応答の種類の結果 |
| ----------------- | ------------ | -------------------- |
| ClientId を唯一のスコープとする | 任意のケース | `id_token`|
| OIDC スコープのみ | 任意のケース | `id_token`|
| ClientId と OIDC スコープの組み合わせ | 任意のケース | `id_token token` |
| リソース スコープ (複数可) と OIDC スコープ (複数可) (技術的には前述と同じ) | 任意のケース | `id_token token` |
| リソース スコープ (複数可) のみ | キャッシュされたアカウント オブジェクトと一致 | `token` |
| リソース スコープ (複数可) と ClientId | キャッシュされたアカウント オブジェクトと一致 | `token` |
| リソース スコープ (複数可) のみ | キャッシュされたアカウント オブジェクトに一致しない | `id_token token` |

**注:上の表に示すように、ClientId が唯一のスコープでない場合は、特別な動作がないリソース スコープであると見なされます。**


