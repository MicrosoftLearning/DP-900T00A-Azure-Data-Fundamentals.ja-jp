---
ms.openlocfilehash: f8a035cf72e9aaa28084cf7e8e5cd0749b5653dc
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052779"
---
# <a name="node-jwa-build-statushttpstravis-ciorgbrianloveswordsnode-jwa"></a>node-jwa [![ビルドの状態](https://travis-ci.org/brianloveswords/node-jwa.svg?branch=master)](https://travis-ci.org/brianloveswords/node-jwa)

[JSON Web Signature](http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html) に必要なアルゴリズムに (この時点では、排他的に) 焦点を当てた [JSON Web アルゴリズム](http://tools.ietf.org/id/draft-ietf-jose-json-web-algorithms-08.html)の実装。

このライブラリは、JWS の必須、推奨、オプションのすべての暗号化アルゴリズムをサポートします。

アルゴリズム パラメーター値 | デジタル署名または MAC アルゴリズム
----------------|----------------------------
HS256 | SHA-256 ハッシュ アルゴリズムを使用する HMAC
HS384 | SHA-384 ハッシュ アルゴリズムを使用する HMAC
HS512 | SHA-512 ハッシュ アルゴリズムを使用する HMAC
RS256 | SHA-256 ハッシュ アルゴリズムを使用する RSASSA
RS384 | SHA-384 ハッシュ アルゴリズムを使用する RSASSA
RS512 | SHA-512 ハッシュ アルゴリズムを使用する RSASSA
PS256 | SHA-256 ハッシュ アルゴリズムを使用する RSASSA-PSS
PS384 | SHA-384 ハッシュ アルゴリズムを使用する RSASSA-PSS
PS512 | SHA-512 ハッシュ アルゴリズムを使用する RSASSA-PSS
ES256 | P-256 曲線と SHA-256 ハッシュ アルゴリズムを使用する ECDSA
ES384 | P-384 曲線と SHA-384 ハッシュ アルゴリズムを使用する ECDSA
ES512 | P-521 曲線と SHA-512 ハッシュ アルゴリズムを使用する ECDSA
なし | デジタル署名または MAC 値は含まれません

PS* はノード 6.12 以降でのみ動作します (7.x を除く)。

# <a name="requirements"></a>要件

テストを実行するには、OpenSSL の最新バージョンが必要です。 **OS X に付属するバージョン (OpenSSL 0.9.8r 8 Feb
2011) は、最新ではありません。** ECDSA キーを完全にサポートしていないためです。 1\.0.0 以上のバージョンを使用する必要があります。OpenSSL 1.0.1c 10 May 2012 でのテストを行いました。

# <a name="testing"></a>テスト

テストを実行するには、次を行います。

```bash
$ npm test
```

これにより、テストで使用するキーペアが大量に生成されます。 新しいキーペアを生成する場合は、`npm test` をもう一度実行する前に `make clean` を行います。

## <a name="methodology"></a>手法

以下を行うために `openssl dgst -sign` を生成します。OpenSSL 署名のテスト → JS 検証と `openssl dgst -verify` を行い JS 署名をテスト → 各 RSA アルゴリズムと ECDSA アルゴリズムの OpenSSL 検証。

# <a name="usage"></a>使用

## <a name="jwaalgorithm"></a>jwa (アルゴリズム)

`sign` および `verify` メソッドを使用して、アルゴリズムの新しい `jwa` オブジェクトを作成します。 アルゴリズムの有効な値は、上の表 (`'HS256'`、`'HS384'` など) にあります。大文字と小文字が区別されます。 無効なアルゴリズム値を渡すと、`TypeError` がスローされます。


## <a name="jwasigninput-secretorprivatekey"></a>jwa#sign (入力、secretOrPrivateKey)

HMAC アルゴリズムのシークレットまたは RSA および ECDSA アルゴリズムの秘密キーを使用して入力に署名します。

入力がまだ文字列またはバッファーでない場合は、その強制を試みるため `JSON.stringify` が呼び出されます。

HMAC アルゴリズムの場合は、`secretOrPrivateKey` は、文字列またはバッファーである必要があります。 ECDSA と RSA の場合、値は PEM でエンコードされた **秘密** キーを表す文字列にする必要があります。

[base64url](http://en.wikipedia.org/wiki/Base64#URL_applications) フォーマットされた出力。 これは、JWS で、この形式の署名が想定されているため、便利です。 アプリケーションで別の形式の出力が必要な場合は、[Issue を開いてください](https://github.com/brianloveswords/node-jwa/issues)。 それまでは、[brianloveswords/base64url](https://github.com/brianloveswords/base64url) を使用して署名をデコードできます。

nodejs *v0.11.8* 以降、SPKAC のサポートが導入されました。 nodeJs のバージョンが満たされている場合は、オブジェクト `{ key: '..', passphrase: '...' }` を渡すことができます


## <a name="jwaverifyinput-signature-secretorpublickey"></a>jwa#verify (入力、署名、secretOrPublicKey)

署名を確認します。 `true` または `false`を返します。

`signature` は base64url でエンコードされた文字列である必要があります。

HMAC アルゴリズムの場合は、`secretOrPublicKey` は、文字列またはバッファーである必要があります。 ECDSA と RSA の場合、値は PEM でエンコードされた **公開** キーを表す文字列である必要があります。


# <a name="example"></a>例

HMAC
```js
const jwa = require('jwa');

const hmac = jwa('HS256');
const input = 'super important stuff';
const secret = 'shhhhhh';

const signature = hmac.sign(input, secret);
hmac.verify(input, signature, secret) // === true
hmac.verify(input, signature, 'trickery!') // === false
```

キーを使用する場合
```js
const fs = require('fs');
const jwa = require('jwa');
const privateKey = fs.readFileSync(__dirname + '/ecdsa-p521-private.pem');
const publicKey = fs.readFileSync(__dirname + '/ecdsa-p521-public.pem');

const ecdsa = jwa('ES512');
const input = 'very important stuff';

const signature = ecdsa.sign(input, privateKey);
ecdsa.verify(input, signature, publicKey) // === true
```
## <a name="license"></a>ライセンス

MIT

```
Copyright (c) 2013 Brian J. Brennan

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```
