---
ms.openlocfilehash: 0dad0f9e52c6ad7304b11c25c495ab90d49a7d98
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052800"
---
# <a name="debug"></a>debug
[![ビルドの状態](https://travis-ci.org/visionmedia/debug.svg?branch=master)](https://travis-ci.org/visionmedia/debug)  [![カバレッジの状態](https://coveralls.io/repos/github/visionmedia/debug/badge.svg?branch=master)](https://coveralls.io/github/visionmedia/debug?branch=master)  [![Slack](https://visionmedia-community-slackin.now.sh/badge.svg)](https://visionmedia-community-slackin.now.sh/) [![OpenCollective](https://opencollective.com/debug/backers/badge.svg)](#backers)
[![OpenCollective](https://opencollective.com/debug/sponsors/badge.svg)](#sponsors)

<img width="647" src="https://user-images.githubusercontent.com/71256/29091486-fa38524c-7c37-11e7-895f-e7ec8e1039b6.png">

Node.js コアのデバッグ手法をモデルにした小さな JavaScript デバッグ ユーティリティ。 Node.js および Web ブラウザーで動作します。

## <a name="installation"></a>インストール

```bash
$ npm install debug
```

## <a name="usage"></a>使用

`debug` では関数を公開します。この関数にモジュールの名前を渡すだけです。デバッグ ステートメントを渡すために装飾されたバージョンの `console.error` が返されます。 これにより、モジュールのさまざまな部分とモジュール全体のデバッグ出力を切り替えることができます。

[_app.js_](./examples/node/app.js) の例:

```js
var debug = require('debug')('http')
  , http = require('http')
  , name = 'My App';

// fake app

debug('booting %o', name);

http.createServer(function(req, res){
  debug(req.method + ' ' + req.url);
  res.end('hello\n');
}).listen(3000, function(){
  debug('listening');
});

// fake worker of some kind

require('./worker');
```

[_worker.js_](./examples/node/worker.js) の例:

```js
var a = require('debug')('worker:a')
  , b = require('debug')('worker:b');

function work() {
  a('doing lots of uninteresting work');
  setTimeout(work, Math.random() * 1000);
}

work();

function workb() {
  b('doing some work');
  setTimeout(workb, Math.random() * 2000);
}

workb();
```

その後、スペースまたはコンマ区切りの名前に基づいて、これらを有効にするために `DEBUG` 環境変数が使用されます。

次に例をいくつか示します。

<img width="647" alt="screen shot 2017-08-08 at 12 53 04 pm" src="https://user-images.githubusercontent.com/71256/29091703-a6302cdc-7c38-11e7-8304-7c0b3bc600cd.png">
<img width="647" alt="screen shot 2017-08-08 at 12 53 38 pm" src="https://user-images.githubusercontent.com/71256/29091700-a62a6888-7c38-11e7-800b-db911291ca2b.png">
<img width="647" alt="screen shot 2017-08-08 at 12 53 25 pm" src="https://user-images.githubusercontent.com/71256/29091701-a62ea114-7c38-11e7-826a-2692bedca740.png">

#### <a name="windows-command-prompt-notes"></a>Windows コマンド プロンプトに関する注意事項

##### <a name="cmd"></a>CMD

Windows では、`set` コマンドを使用して環境変数が設定されます。

```cmd
set DEBUG=*,-not_this
```

例:

```cmd
set DEBUG=* & node app.js
```

##### <a name="powershell-vs-code-default"></a>PowerShell (既定: VS Code)

PowerShell では、さまざまな構文を使用して環境変数を設定します。

```cmd
$env:DEBUG = "*,-not_this"
```

例:

```cmd
$env:DEBUG='app';node app.js
```

次に、通常どおりにデバッグするプログラムを実行します。

npm スクリプトの例:
```js
  "windowsDebug": "@powershell -Command $env:DEBUG='*';node app.js",
```

## <a name="namespace-colors"></a>名前空間の色

すべてのデバッグ インスタンスには、名前空間名に基づいて生成された色があります。
これは、デバッグ出力を視覚的に解析し、デバッグ行がどのデバッグ インスタンスに属するかを識別するのに役立ちます。

#### <a name="nodejs"></a>Node.js

Node.js では、stderr が TTY の場合、色が有効になります。 また、デバッグと並行して [`supports-color`](https://npmjs.org/supports-color) モジュールをインストールする ''_必要があります_''。それ以外の場合、デバッグではごく少数の基本色のみが使用されます。

<img width="521" src="https://user-images.githubusercontent.com/71256/29092181-47f6a9e6-7c3a-11e7-9a14-1928d8a711cd.png">

#### <a name="web-browser"></a>Web ブラウザー

`%c` 書式設定オプションを理解する [Web インスペクタ] でも色が有効になります。 これらは、WebKit Web インスペクタ、Firefox ([バージョン 31 以降](https://hacks.mozilla.org/2014/05/editable-box-model-multiple-selection-sublime-text-keys-much-more-firefox-developer-tools-episode-31/)) および Firefox (任意のバージョン) 用の Firebug プラグインです。

<img width="524" src="https://user-images.githubusercontent.com/71256/29092033-b65f9f2e-7c39-11e7-8e32-f6f0d8e865c1.png">


## <a name="millisecond-diff"></a>ミリ秒の差分

アプリケーションを積極的に開発するときは、1 つの `debug()` 呼び出しと次の呼び出しの間にかかった時間を確認すると役立つ場合があります。 たとえば、リソースを要求する前に `debug()` を呼び出すとします。その後も、呼び出しの間にかかった時間が "+NNNms" で示されます。

<img width="647" src="https://user-images.githubusercontent.com/71256/29091486-fa38524c-7c37-11e7-895f-e7ec8e1039b6.png">

stdout が TTY でない場合は、`Date#toISOString()` が使用されます。これは、以下に示すようにデバッグ情報のログ記録により役立ちます。

<img width="647" src="https://user-images.githubusercontent.com/71256/29091956-6bd78372-7c39-11e7-8c55-c948396d6edd.png">


## <a name="conventions"></a>規約

1 つまたは複数のライブラリでこれを使用している場合は、開発者が名前を推測せずに必要に応じてデバッグを切り替えることができるように、ライブラリの名前を使用する ''_必要があります_''。 複数のデバッガーがある場合は、それらの前にライブラリ名を付け、":" を使用して機能を区切る ''_必要があります_''。 たとえば、Connect の "bodyParser" は "connect:bodyParser" になります。  名前の末尾に "*" を追加すると、DEBUG 環境変数の設定に関係なく、常に有効になります。  その後、通常の出力とデバッグ出力に使用できます。

## <a name="wildcards"></a>ワイルドカード

`*` 文字はワイルドカードとして使用できます。 たとえば、ライブラリに "connect:bodyParser"、"connect:compress"、"connect:session" という名前のデバッガーがあるとします。`DEBUG=connect:bodyParser,connect:compress,connect:session` を使用して 3 つすべてを一覧表示する代わりに、単に `DEBUG=connect:*` を実行することができます。あるいは、このモジュールを使用してすべてを実行する場合は、単に `DEBUG=*` を使用します。

また、特定のデバッガーは、その前に "-" 文字を付けることで除外できます。
たとえば、`DEBUG=*,-connect:*` の場合、"connect:" で始まるものを除くすべてのデバッガーが含まれます。

## <a name="environment-variables"></a>環境変数

Node.js を実行するときに、デバッグ ログの動作を変更するいくつかの環境変数を設定できます。

| 名前      | 目的                                         |
|-----------|-------------------------------------------------|
| `DEBUG`   | 特定のデバッグ名前空間を有効または無効にします。 |
| `DEBUG_HIDE_DATE` | デバッグ出力 (TTY 以外) の日付を非表示にします。  |
| `DEBUG_COLORS`| デバッグ出力で色を使用するかどうか。 |
| `DEBUG_DEPTH` | オブジェクト検査の深さ。                    |
| `DEBUG_SHOW_HIDDEN` | 検査対象オブジェクトの非表示プロパティを表示します。 |


__注:__  `DEBUG_` で始まる環境変数は最終的には、`%o`/`%O` フォーマッタで使用されるオプション オブジェクトに変換されます。
[`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options) の Node.js ドキュメントを参照し、
完全な一覧を確認してください。

## <a name="formatters"></a>フォーマッタ

デバッグでは [、printf スタイル](https://wikipedia.org/wiki/Printf_format_string)の書式設定が使用されます。
公式にサポートされているフォーマッタを以下に示します。

| フォーマッタ | 表現 |
|-----------|----------------|
| `%O`      | オブジェクトを複数行に整形出力します。 |
| `%o`      | オブジェクトをすべて 1 行で整形出力します。 |
| `%s`      | 文字列 をオンにします。 |
| `%d`      | 数値 (整数と浮動小数点数の両方)。 |
| `%j`      | JSON。 引数に循環参照が含まれている場合は、文字列 '[Circular]' に置き換えられます。 |
| `%%`      | シングル パーセント記号 ('%')。 この場合、引数は使用されません。 |


### <a name="custom-formatters"></a>カスタム フォーマッタ

`debug.formatters` オブジェクトを拡張することで、カスタム フォーマッタを追加できます。
たとえば、`%h` を使用してバッファーを 16 進数としてレンダリングするためのサポートを追加する場合は、次のようにすることができます。

```js
const createDebug = require('debug')
createDebug.formatters.h = (v) => {
  return v.toString('hex')
}

// …elsewhere
const debug = createDebug('foo')
debug('this is hex: %h', new Buffer('hello world'))
//   foo this is hex: 68656c6c6f20776f726c6421 +0ms
```


## <a name="browser-support"></a>ブラウザー サポート

[browserify](https://github.com/substack/node-browserify) を使用して、ブラウザー対応スクリプトをビルドすることができます。自分でビルドしたくない場合は、単に[サービスとしての browserify](https://wzrd.in/) [ビルド](https://wzrd.in/standalone/debug@latest)を使用することもできます。

デバッグの有効化状態は現在、`localStorage` によって保持されています。
以下に示す状況を考えてみましょう。`worker:a` と `worker:b` があり、両方をデバッグすることを望んでいます。 これは `localStorage.debug` を使用して有効にできます。

```js
localStorage.debug = 'worker:*'
```

その後、ページを更新します。

```js
a = debug('worker:a');
b = debug('worker:b');

setInterval(function(){
  a('doing some work');
}, 1000);

setInterval(function(){
  b('doing some work');
}, 1200);
```


## <a name="output-streams"></a>出力ストリーム

  `debug` では既定で stderr にログが記録されますが、これは `log` メソッドをオーバーライドすることで名前空間ごとに構成できます。

[_stdout.js_](./examples/node/stdout.js) の例:

```js
var debug = require('debug');
var error = debug('app:error');

// by default stderr is used
error('goes to stderr!');

var log = debug('app:log');
// set this namespace to log via console.log
log.log = console.log.bind(console); // don't forget to bind to console!
log('goes to stdout');
error('still goes to stderr!');

// set all output to go via console.info
// overrides all per-namespace log settings
debug.log = console.info.bind(console);
error('now goes to stdout via console.info');
log('still goes to stdout, but via console.info now');
```

## <a name="extend"></a>拡張
デバッガーを拡張するだけで済みます 
```js
const log = require('debug')('auth');

//creates new debug instance with extended namespace
const logSign = log.extend('sign');
const logLogin = log.extend('login');

log('hello'); // auth hello
logSign('hello'); //auth:sign hello
logLogin('hello'); //auth:login hello
```

## <a name="set-dynamically"></a>動的に設定する

`enable()` メソッドを呼び出すことで、デバッグを動的に有効にすることもできます。

```js
let debug = require('debug');

console.log(1, debug.enabled('test'));

debug.enable('test');
console.log(2, debug.enabled('test'));

debug.disable();
console.log(3, debug.enabled('test'));

```

出力 :   
```
1 false
2 true
3 false
```

使用法 :  
`enable(namespaces)`  
`namespaces` には、コロンとワイルドカードで区切られたモードを含めることができます。
   
`enable()` を呼び出すと、以前に設定された DEBUG 変数が完全にオーバーライドされることに注意してください。 

```
$ DEBUG=foo node -e 'var dbg = require("debug"); dbg.enable("bar"); console.log(dbg.enabled("foo"))'
=> false
```

`disable()`

すべての名前空間を無効にします。 関数により、現在有効化 (およびスキップ) されている名前空間が返されます。 これは、最初に何が有効にされたのかがわからない状態でデバッグを一時的に無効にする場合に役立つことがあります。

次に例を示します。

```js
let debug = require('debug');
debug.enable('foo:*,-foo:bar');
let namespaces = debug.disable();
debug.enable(namespaces);
```

注: 文字列が最初の有効化文字列と同じになる保証はありませんが、意味的には同じになります。

## <a name="checking-whether-a-debug-target-is-enabled"></a>デバッグ ターゲットが有効になっているかどうかの確認

デバッグ インスタンスを作成した後は、`enabled` プロパティを確認して有効かどうかを判断できます。

```javascript
const debug = require('debug')('http');

if (debug.enabled) {
  // do stuff...
}
```

このプロパティを手動で切り替えて、デバッグ インスタンスを強制的に有効または無効にすることもできます。


## <a name="authors"></a>Authors

 - TJ Holowaychuk
 - Nathan Rajlich
 - Andrew Rhyne

## <a name="backers"></a>支援者

毎月寄付をしてサポートし、当社が活動を続けられるようにします。 [[支援者になる](https://opencollective.com/debug#backer)]

<a href="https://opencollective.com/debug/backer/0/website" target="_blank"><img src="https://opencollective.com/debug/backer/0/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/1/website" target="_blank"><img src="https://opencollective.com/debug/backer/1/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/2/website" target="_blank"><img src="https://opencollective.com/debug/backer/2/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/3/website" target="_blank"><img src="https://opencollective.com/debug/backer/3/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/4/website" target="_blank"><img src="https://opencollective.com/debug/backer/4/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/5/website" target="_blank"><img src="https://opencollective.com/debug/backer/5/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/6/website" target="_blank"><img src="https://opencollective.com/debug/backer/6/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/7/website" target="_blank"><img src="https://opencollective.com/debug/backer/7/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/8/website" target="_blank"><img src="https://opencollective.com/debug/backer/8/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/9/website" target="_blank"><img src="https://opencollective.com/debug/backer/9/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/10/website" target="_blank"><img src="https://opencollective.com/debug/backer/10/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/11/website" target="_blank"><img src="https://opencollective.com/debug/backer/11/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/12/website" target="_blank"><img src="https://opencollective.com/debug/backer/12/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/13/website" target="_blank"><img src="https://opencollective.com/debug/backer/13/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/14/website" target="_blank"><img src="https://opencollective.com/debug/backer/14/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/15/website" target="_blank"><img src="https://opencollective.com/debug/backer/15/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/16/website" target="_blank"><img src="https://opencollective.com/debug/backer/16/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/17/website" target="_blank"><img src="https://opencollective.com/debug/backer/17/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/18/website" target="_blank"><img src="https://opencollective.com/debug/backer/18/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/19/website" target="_blank"><img src="https://opencollective.com/debug/backer/19/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/20/website" target="_blank"><img src="https://opencollective.com/debug/backer/20/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/21/website" target="_blank"><img src="https://opencollective.com/debug/backer/21/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/22/website" target="_blank"><img src="https://opencollective.com/debug/backer/22/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/23/website" target="_blank"><img src="https://opencollective.com/debug/backer/23/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/24/website" target="_blank"><img src="https://opencollective.com/debug/backer/24/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/25/website" target="_blank"><img src="https://opencollective.com/debug/backer/25/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/26/website" target="_blank"><img src="https://opencollective.com/debug/backer/26/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/27/website" target="_blank"><img src="https://opencollective.com/debug/backer/27/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/28/website" target="_blank"><img src="https://opencollective.com/debug/backer/28/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/29/website" target="_blank"><img src="https://opencollective.com/debug/backer/29/avatar.svg"></a>


## <a name="sponsors"></a>スポンサー

スポンサーになり、GitHub の README にロゴを入れ、サイトへのリンクを表示します。 [[スポンサーになる](https://opencollective.com/debug#sponsor)]

<a href="https://opencollective.com/debug/sponsor/0/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/0/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/1/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/1/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/2/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/2/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/3/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/3/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/4/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/4/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/5/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/5/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/6/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/6/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/7/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/7/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/8/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/8/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/9/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/9/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/10/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/10/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/11/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/11/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/12/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/12/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/13/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/13/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/14/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/14/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/15/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/15/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/16/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/16/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/17/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/17/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/18/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/18/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/19/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/19/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/20/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/20/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/21/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/21/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/22/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/22/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/23/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/23/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/24/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/24/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/25/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/25/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/26/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/26/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/27/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/27/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/28/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/28/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/29/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/29/avatar.svg"></a>

## <a name="license"></a>ライセンス

(MIT ライセンス)

Copyright (c) 2014-2017 TJ Holowaychuk &lt;tj@vision-media.ca&gt;

以下に定める条件に従って、本ソフトウェアおよび関連文書ファイルのコピー (以下、''ソフトウェア'') を取得したすべての人物に対して、ソフトウェアのコピーを使用、コピー、修正、結合、発行、配布、サブライセンス、または販売すること、およびソフトウェアの供給先がこれらを行うことを許可する無制限の権利も含めて、本ソフトウェアを制限なしで扱う許可を無償で与えます。

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

ソフトウェアは ''現状のまま'' で提供され、明示的または暗黙的にかかわらず、市販性、特定用途への適合性、および権利侵害がないことも含めて、何らかの保証が提供されることはありません。
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
